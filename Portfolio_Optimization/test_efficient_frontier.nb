(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27543,        688]
NotebookOptionsPosition[     24337,        627]
NotebookOutlinePosition[     24711,        643]
CellTagsIndexPosition[     24668,        640]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"sample", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"100", ",", "300"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "10"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.827654353362796*^9, 3.8276543662304726`*^9}, {
  3.8276543970696197`*^9, 3.8276544490294847`*^9}, {3.827654548630234*^9, 
  3.82765456159044*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"a86b188e-b1ff-4af7-ab5c-d60e4232cdcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"quotes", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"array", "=", 
       RowBox[{"{", "}"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"array", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sample", "\[LeftDoubleBracket]", 
                RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}], "-", 
               RowBox[{"sample", "\[LeftDoubleBracket]", 
                RowBox[{"j", ",", 
                 RowBox[{"i", "-", "1"}]}], "\[RightDoubleBracket]"}]}], 
              ")"}], "/", 
             RowBox[{"sample", "\[LeftDoubleBracket]", 
              RowBox[{"j", ",", 
               RowBox[{"i", "-", "1"}]}], "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "@", 
               RowBox[{
               "sample", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", "array"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8276544516406083`*^9, 3.827654454758108*^9}, {
  3.8276549068867307`*^9, 3.827655129168707*^9}, {3.827655180031343*^9, 
  3.827655229667379*^9}, {3.827655355377351*^9, 3.8276553574526834`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"c7f1ed86-49b1-4be2-930f-d9c30d339108"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"return", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Mean", "[", "#", "]"}], "&"}], "/@", "quotes"}]}]], "Input",
 CellChangeTimes->{{3.82765504988249*^9, 3.827655050483372*^9}, {
  3.827655237474206*^9, 3.82765529717931*^9}, {3.827655362190471*^9, 
  3.827655363340253*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"1f9b7903-6b41-4dd9-a37b-4c4978fb6f01"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.007985064741223001`", ",", "0.08778745112992668`", ",", 
   "0.11358399158875827`", ",", "0.12300428960765387`", ",", 
   "0.12639484240361767`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8276552340527315`*^9, {3.827655284850443*^9, 3.827655297669525*^9}, 
   3.827655363801747*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"9b5ed108-76b9-4a54-8993-300362bcae2e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"covMatrix", "=", 
   RowBox[{"Covariance", "[", 
    RowBox[{"quotes", "//", "Transpose"}], "]"}]}], ";", 
  "\[AliasDelimiter]"}]], "Input",
 CellChangeTimes->{{3.8276552990188646`*^9, 3.827655317417575*^9}, {
   3.8276553660480857`*^9, 3.8276554016242714`*^9}, 
   3.8276573538496585`*^9},ExpressionUUID->"0968780c-03d5-4dcb-ac37-\
7a9ed1faed2f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"l", "=", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8276554482753744`*^9, 3.8276554523931546`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"5fe55b39-e485-41be-9ec2-dbd2975332a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.8276554527336617`*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"3db3c0c4-ce02-489c-a64d-0f54be6765fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"h0", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Inverse", "[", "covMatrix", "]"}], ".", "l"}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"l", ".", 
     RowBox[{"Inverse", "[", "covMatrix", "]"}], ".", "l"}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.827655421414136*^9, 3.827655489530158*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"240b3680-5b72-4eb2-9e88-0b994c2681ce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.4986774742503493`", ",", "0.28823197262516537`", ",", 
   "0.44741023780063816`", ",", "0.12433506808912755`", ",", 
   RowBox[{"-", "0.35865475276528025`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8276554326328487`*^9, 3.8276554899150543`*^9}},
 CellLabel->"Out[38]=",ExpressionUUID->"2bafda49-e3ce-4ff1-b0aa-4d2f30d98197"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"h1", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Inverse", "[", "covMatrix", "]"}], ".", "return"}], ")"}], "-", 
   RowBox[{
    RowBox[{
     RowBox[{"Inverse", "[", "covMatrix", "]"}], ".", "l"}], "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"l", ".", 
       RowBox[{"Inverse", "[", "covMatrix", "]"}], ".", "return"}], ")"}], 
     "/", 
     RowBox[{"(", 
      RowBox[{"l", ".", 
       RowBox[{"Inverse", "[", "covMatrix", "]"}], ".", "l"}], 
      ")"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.827655501873966*^9, 3.827655566110758*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"36d32681-c27b-4087-8cb1-72601f3353e0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.9139089788011139`"}], ",", "0.11678705091850772`", ",", 
   RowBox[{"-", "0.11856928012485235`"}], ",", "0.1644564046567254`", ",", 
   "0.7512348033507329`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8276555589788723`*^9, 3.8276555665650225`*^9}},
 CellLabel->"Out[41]=",ExpressionUUID->"6b8f87de-3eb0-4189-bdc4-3c212a08adf7"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Alpha]0", "=", 
   RowBox[{"return", ".", "h0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]1", "=", 
   RowBox[{"return", ".", "h1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]0", "=", 
   RowBox[{"h0", ".", "covMatrix", ".", "h0"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8276555717789536`*^9, 3.8276556449857707`*^9}, {
  3.827655704954547*^9, 3.827655713541741*^9}, {3.827655787324975*^9, 
  3.827655790033598*^9}},ExpressionUUID->"b8cf3a24-762c-4383-9ecc-\
2dd824094431"],

Cell[CellGroupData[{

Cell[BoxData["\[Alpha]0"], "Input",
 CellChangeTimes->{{3.827655932696002*^9, 3.827655934602879*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"10045d67-5b88-41fc-9d08-b6caf5da0662"],

Cell[BoxData["0.05006539858541105`"], "Output",
 CellChangeTimes->{3.827655935148424*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"0343513f-3f21-4781-adbb-85a491ece85d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "x_", "]"}], ":=", 
  RowBox[{
   SqrtBox[
    RowBox[{"\[Alpha]1", "*", 
     RowBox[{"(", 
      RowBox[{"x", "-", "\[Beta]0"}], ")"}]}]], "+", "\[Alpha]0"}]}]], "Input",
 CellChangeTimes->{{3.8276558208117647`*^9, 3.827655836498494*^9}, {
  3.827655884148403*^9, 3.8276559029527717`*^9}, {3.827655963728139*^9, 
  3.8276559723829536`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"93b77711-4882-4042-aea2-6254a268677f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"f", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0.6"}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.827655904999613*^9, 3.8276559191248255`*^9}, {
  3.827656003866283*^9, 3.8276560240277276`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"dce9075e-979c-4193-8674-44bd85400873"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1: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
       "]]},
     Annotation[#, "Charting`Private`Tag$20894#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->{388.57142857143265`, Automatic},
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 0.9999999795918367}, {0, 0.6}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.8276559210209503`*^9, {3.827655966092447*^9, 3.8276559818563833`*^9}, {
   3.8276560171296034`*^9, 3.8276560243628283`*^9}},
 CellLabel->"Out[64]=",ExpressionUUID->"30138e96-5316-467b-b349-b3aa58339c4d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fun", "[", "x_", "]"}], ":=", 
  RowBox[{"x", ".", "return"}]}]], "Input",
 CellChangeTimes->{{3.8276561380289154`*^9, 3.8276561909304085`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"af9df1b7-ef82-4ecc-899b-2d65ddda3cbd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"Minimize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"fun", "[", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "}"}], 
        "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "}"}], 
        ".", "l"}], "==", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "}"}], 
        ".", "covMatrix", ".", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "}"}]}], 
       "<=", "0.09"}], ",", 
      RowBox[{"x1", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{"x2", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{"x3", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{"x4", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{"x5", "\[GreaterEqual]", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8276560308395705`*^9, 3.8276560339911213`*^9}, {
  3.827656163406842*^9, 3.8276561654854107`*^9}, {3.8276561959904976`*^9, 
  3.8276562935333147`*^9}, {3.8276564624694147`*^9, 3.827656529655923*^9}, {
  3.8276565766271524`*^9, 3.82765660083346*^9}, {3.827656734006201*^9, 
  3.827656820036584*^9}, {3.827656888072629*^9, 3.8276569592184386`*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"795550c5-88f1-452c-9f69-093c55700269"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.1155410597920189`"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"-", "2.8089966159752745`*^-7"}]}], ",", 
     RowBox[{"x2", "\[Rule]", "0.15596450135519044`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.2885572494394921`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.335049343208215`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.22043103046310122`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.827656167731527*^9, {3.8276562002770286`*^9, 3.8276562088872185`*^9}, {
   3.827656241981956*^9, 3.8276562470854616`*^9}, {3.8276562797676244`*^9, 
   3.827656294071005*^9}, 3.827656361375118*^9, {3.8276564773923*^9, 
   3.8276565341310253`*^9}, {3.827656578131687*^9, 3.827656601305584*^9}, 
   3.827656734434469*^9, {3.8276567668890557`*^9, 3.827656820298602*^9}, {
   3.8276568892942033`*^9, 3.827656959528818*^9}},
 CellLabel->
  "Out[133]=",ExpressionUUID->"892a2f13-7bae-4d61-a91d-40ae3857c2fa"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rf", "=", "0.0037"}], ";"}]], "Input",
 CellChangeTimes->{{3.827657001814265*^9, 3.827657007462145*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"82b86cbe-1011-4d6a-bbac-c35ad19561dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fun", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"x", ".", "return"}], "-", "rf"}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"x", ".", "covMatrix", ".", "x"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.827656983973938*^9, 3.8276570252625523`*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"0fcb11be-a094-4f0d-bc40-75fc13286ce7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol1", "=", 
  RowBox[{"Minimize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"fun", "[", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "}"}], 
        "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "}"}], 
        ".", "l"}], "==", "1"}], ",", 
      RowBox[{"x1", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{"x2", "\[GreaterEqual]", "0.05"}], ",", 
      RowBox[{"x3", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{"x4", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{"x5", "\[GreaterEqual]", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8276570274050407`*^9, 3.8276570488912315`*^9}, {
  3.8276571083115964`*^9, 3.827657108935949*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"04515427-e6f3-49d4-87bf-9c4ca1195c37"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.12446447283993312`"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "0.`"}], ",", 
     RowBox[{"x2", "\[Rule]", "0.05`"}], ",", 
     RowBox[{"x3", "\[Rule]", "0.`"}], ",", 
     RowBox[{"x4", "\[Rule]", "0.`"}], ",", 
     RowBox[{"x5", "\[Rule]", "0.95`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8276570515111823`*^9, 3.827657109592165*^9},
 CellLabel->
  "Out[142]=",ExpressionUUID->"486fdabc-925d-4fd0-a462-f5623ecf647d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"w", "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sol1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "//",
     "Values"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8276566313189783`*^9, 3.8276566361851177`*^9}, 
   3.8276570584990892`*^9},
 CellLabel->
  "In[143]:=",ExpressionUUID->"1ed32247-8200-4dac-a759-8683811d7c87"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.05`", ",", "0.`", ",", "0.`", ",", "0.95`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.827656637026903*^9, 3.827656735664687*^9, {3.8276567705219083`*^9, 
   3.8276568218436327`*^9}, {3.827656890340581*^9, 3.827656907062147*^9}, {
   3.827656949288741*^9, 3.8276569602667437`*^9}, 3.827657059158839*^9, 
   3.8276571112604556`*^9},
 CellLabel->
  "Out[143]=",ExpressionUUID->"07f294e8-9dab-434b-93c2-2c95160449e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"f", "[", "x", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.6"}], "}"}]}], "}"}]}]}], "]"}], ",", 
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"w", ".", "covMatrix", ".", "w"}], ",", 
          RowBox[{"w", ".", "return"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8276566027227664`*^9, 3.8276567256395245`*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"ca85b0ca-61fb-4fd9-bfa8-d5dcb66b37ca"],

Cell[BoxData[
 GraphicsBox[{{{{}, {}, 
     TagBox[
      {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
       Opacity[1.], LineBox[CompressedData["
1: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
        "]]},
      Annotation[#, "Charting`Private`Tag$305506#1"]& ]}, {}}, 
   {PointSize[0.01], PointBox[{0.2907009815905676, 0.12446447283993312`}]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 0.9999999795918367}, {0, 0.6}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.827656611827881*^9, 3.827656624258241*^9}, {
   3.8276566936280336`*^9, 3.82765673651266*^9}, {3.827656772663658*^9, 
   3.8276568226453047`*^9}, {3.827656891074259*^9, 3.8276569079805975`*^9}, {
   3.827656950048023*^9, 3.827656960910643*^9}, 3.827657060180897*^9, 
   3.827657112026511*^9},
 CellLabel->
  "Out[144]=",ExpressionUUID->"95f044d6-c0b7-40a6-8a89-adbded606e14"]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.4 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 493, 12, 40, "Input",ExpressionUUID->"a86b188e-b1ff-4af7-ab5c-d60e4232cdcb"],
Cell[1054, 34, 1606, 39, 97, "Input",ExpressionUUID->"c7f1ed86-49b1-4be2-930f-d9c30d339108"],
Cell[CellGroupData[{
Cell[2685, 77, 376, 8, 40, "Input",ExpressionUUID->"1f9b7903-6b41-4dd9-a37b-4c4978fb6f01"],
Cell[3064, 87, 408, 9, 46, "Output",ExpressionUUID->"9b5ed108-76b9-4a54-8993-300362bcae2e"]
}, Open  ]],
Cell[3487, 99, 383, 9, 40, "Input",ExpressionUUID->"0968780c-03d5-4dcb-ac37-7a9ed1faed2f"],
Cell[CellGroupData[{
Cell[3895, 112, 275, 5, 40, "Input",ExpressionUUID->"5fe55b39-e485-41be-9ec2-dbd2975332a8"],
Cell[4173, 119, 226, 4, 46, "Output",ExpressionUUID->"3db3c0c4-ce02-489c-a64d-0f54be6765fc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4436, 128, 421, 11, 40, "Input",ExpressionUUID->"240b3680-5b72-4eb2-9e88-0b994c2681ce"],
Cell[4860, 141, 372, 7, 46, "Output",ExpressionUUID->"2bafda49-e3ce-4ff1-b0aa-4d2f30d98197"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5269, 153, 674, 19, 40, "Input",ExpressionUUID->"36d32681-c27b-4087-8cb1-72601f3353e0"],
Cell[5946, 174, 386, 7, 46, "Output",ExpressionUUID->"6b8f87de-3eb0-4189-bdc4-3c212a08adf7"]
}, Open  ]],
Cell[6347, 184, 557, 13, 97, "Input",ExpressionUUID->"b8cf3a24-762c-4383-9ecc-2dd824094431"],
Cell[CellGroupData[{
Cell[6929, 201, 180, 2, 40, "Input",ExpressionUUID->"10045d67-5b88-41fc-9d08-b6caf5da0662"],
Cell[7112, 205, 168, 2, 46, "Output",ExpressionUUID->"0343513f-3f21-4781-adbb-85a491ece85d"]
}, Open  ]],
Cell[7295, 210, 465, 11, 45, "Input",ExpressionUUID->"93b77711-4882-4042-aea2-6254a268677f"],
Cell[CellGroupData[{
Cell[7785, 225, 530, 13, 40, "Input",ExpressionUUID->"dce9075e-979c-4193-8674-44bd85400873"],
Cell[8318, 240, 4435, 91, 380, "Output",ExpressionUUID->"30138e96-5316-467b-b349-b3aa58339c4d"]
}, Open  ]],
Cell[12768, 334, 258, 5, 40, "Input",ExpressionUUID->"af9df1b7-ef82-4ecc-899b-2d65ddda3cbd"],
Cell[CellGroupData[{
Cell[13051, 343, 1574, 38, 69, "Input",ExpressionUUID->"795550c5-88f1-452c-9f69-093c55700269"],
Cell[14628, 383, 1000, 21, 50, "Output",ExpressionUUID->"892a2f13-7bae-4d61-a91d-40ae3857c2fa"]
}, Open  ]],
Cell[15643, 407, 222, 5, 40, "Input",ExpressionUUID->"82b86cbe-1011-4d6a-bbac-c35ad19561dc"],
Cell[15868, 414, 403, 11, 40, "Input",ExpressionUUID->"0fcb11be-a094-4f0d-bc40-75fc13286ce7"],
Cell[CellGroupData[{
Cell[16296, 429, 1038, 27, 40, "Input",ExpressionUUID->"04515427-e6f3-49d4-87bf-9c4ca1195c37"],
Cell[17337, 458, 518, 13, 46, "Output",ExpressionUUID->"486fdabc-925d-4fd0-a462-f5623ecf647d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17892, 476, 360, 9, 40, "Input",ExpressionUUID->"1ed32247-8200-4dac-a759-8683811d7c87"],
Cell[18255, 487, 472, 10, 46, "Output",ExpressionUUID->"07f294e8-9dab-434b-93c2-2c95160449e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18764, 502, 911, 26, 40, "Input",ExpressionUUID->"ca85b0ca-61fb-4fd9-bfa8-d5dcb66b37ca"],
Cell[19678, 530, 4643, 94, 355, "Output",ExpressionUUID->"95f044d6-c0b7-40a6-8a89-adbded606e14"]
}, Open  ]]
}
]
*)

